<!DOCTYPE html>
<html lang="de">
<head>
    
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="f243262c-6703-4c73-8563-6d1501597454" type="text/javascript" async></script>
    
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-54MQEM2R71"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-54MQEM2R71');
</script>



    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConvertPro - Kostenloser Bildkonverter & Hintergrund Entferner</title>
    <meta name="description" content="Kostenloser Online-Konverter für Bilder (JPG, PNG, WEBP, GIF) und PDFs. Professionelle Hintergrund-Entfernung für PowerPoint und Flyer. Schnell, sicher und kostenlos.">
    <meta name="keywords" content="Bildkonverter, JPG zu PNG, Hintergrund entfernen, Background Remover, PowerPoint, Flyer, kostenlos, online">
    <meta name="author" content="ConvertPro">
    
    <!-- Open Graph Meta Tags für Social Media -->
    <meta property="og:title" content="ConvertPro - Kostenloser Bildkonverter & Hintergrund Entferner">
    <meta property="og:description" content="Konvertieren Sie Bilder und entfernen Sie Hintergründe professionell - kostenlos online!">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/favicon-192x192.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzY2N0VFQSIvPgo8cGF0aCBkPSJNMTYgOEwxMiAxMkgxNUgxN0gyMEwxNiA4WiIgZmlsbD0id2hpdGUiLz4KPHN2Zz4K">
    
    <!-- Google AdSense - Ersetzen Sie 'ca-pub-XXXXX' mit Ihrer AdSense Publisher ID -->
    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-IHRE-ADSENSE-ID"></script> -->
    
    <!-- Google Analytics - Ersetzen Sie 'G-XXXXX' mit Ihrer Analytics ID -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-IHRE-ANALYTICS-ID"></script> -->
    <!-- <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-IHRE-ANALYTICS-ID');
    </script> -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            align-items: start;
        }

        .ad-space {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .ad-placeholder {
            color: #999;
            font-size: 14px;
            text-align: center;
        }

        .converter-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .trust-badge {
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            color: #667eea;
            font-weight: 600;
        }

        .format-section {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            padding: 25px;
            border-radius: 15px;
        }

        .format-group {
            text-align: center;
        }

        .format-label {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
        }

        select {
            padding: 12px 18px;
            font-size: 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            background: white;
            min-width: 200px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }

        .arrow {
            font-size: 24px;
            color: #667eea;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 50px 30px;
            text-align: center;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-color: #764ba2;
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            border-color: #4CAF50;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .upload-subtext {
            color: #666;
            font-size: 14px;
        }

        .file-info {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
            border-left: 4px solid #667eea;
        }

        .convert-btn {
            width: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .convert-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .convert-btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .convert-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .convert-btn:disabled {
            background: linear-gradient(45deg, #ccc, #aaa);
            cursor: not-allowed;
            transform: none;
        }

        .convert-btn.remove-bg {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
        }

        .convert-btn.remove-bg:hover:not(:disabled) {
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .progress {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            margin: 20px 0;
            display: none;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(45deg, rgba(255,255,255,.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.2) 50%, rgba(255,255,255,.2) 75%, transparent 75%, transparent);
            background-size: 20px 20px;
            animation: move 1s linear infinite;
        }

        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 20px 20px; }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .feature {
            text-align: center;
            padding: 25px;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .feature:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.1);
        }

        .feature-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .feature-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }

        .feature-text {
            color: #666;
            font-size: 14px;
            line-height: 1.4;
        }

        .bottom-ad {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 30px auto;
            max-width: 728px;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            padding: 30px 0;
            margin-top: 40px;
        }

        .footer-links {
            margin: 20px 0;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            margin: 0 15px;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: white;
        }

        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .converter-card {
                padding: 25px;
            }
            
            .format-section {
                flex-direction: column;
                gap: 15px;
            }
            
            .arrow {
                transform: rotate(90deg);
            }
            
            select {
                min-width: 100%;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #4CAF50;
            color: white;
            border-radius: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #f44336;
        }

        input[type="file"] {
            display: none;
        }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-layout">
            <!-- Linke Werbefläche -->
            <div class="ad-space">
                <div class="ad-placeholder">
                    <strong>📢 Werbeplatz 300x250</strong><br><br>
                    Hier erscheint Ihre<br>
                    Google AdSense Werbung<br><br>
                    <small>Hohe Klickrate durch<br>relevante Zielgruppe</small>
                </div>
            </div>

            <!-- Hauptinhalt -->
            <div class="converter-card">
                <div class="header">
                    <div class="logo">🔄 ConvertPro</div>
                    <div class="subtitle">Kostenloser Universal-Konverter & Hintergrund-Entferner</div>
                    <div class="trust-badges">
                        <span class="trust-badge">🔒 100% Sicher</span>
                        <span class="trust-badge">⚡ Blitzschnell</span>
                        <span class="trust-badge">💯 Kostenlos</span>
                        <span class="trust-badge">🚀 Keine Anmeldung</span>
                    </div>
                </div>

                <div class="format-section">
                    <div class="format-group">
                        <div class="format-label">Von Format:</div>
                        <select id="sourceFormat">
                            <option value="jpg">🖼️ JPG/JPEG - Komprimierte Bilder</option>
                            <option value="png">🎨 PNG - Transparente Bilder</option>
                            <option value="webp">🌐 WEBP - Moderne Webbilder</option>
                            <option value="gif">🎞️ GIF - Animierte Bilder</option>
                            <option value="bmp">🖼️ BMP - Windows Bitmap</option>
                            <option value="pdf">📄 PDF - Dokumente</option>
                        </select>
                    </div>

                    <div class="arrow">→</div>

                    <div class="format-group">
                        <div class="format-label">Zu Format:</div>
                        <select id="targetFormat">
                            <option value="png">🎨 PNG - Beste Qualität</option>
                            <option value="jpg">🖼️ JPG - Kleinere Dateien</option>
                            <option value="webp">🌐 WEBP - Web-optimiert</option>
                            <option value="gif">🎞️ GIF - Für Animationen</option>
                            <option value="remove-bg">✂️ Hintergrund entfernen</option>
                            <option value="pptx">📊 PowerPoint (.pptx)</option>
                        </select>
                    </div>
                </div>

                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">📁</div>
                    <div class="upload-text">Datei hier ablegen oder klicken</div>
                    <div class="upload-subtext">JPG, PNG, WEBP, GIF, BMP, PDF - max. 10MB</div>
                </div>

                <input type="file" id="fileInput" accept="image/*,.pdf">

                <div class="file-info" id="fileInfo"></div>

                <div class="progress" id="progress">
                    <div class="progress-bar" id="progressBar"></div>
                </div>

                <button class="convert-btn" id="convertBtn" disabled>
                    📁 Zuerst Datei auswählen
                </button>

                <div class="features">
                    <div class="feature">
                        <div class="feature-icon">⚡</div>
                        <div class="feature-title">Blitzschnell</div>
                        <div class="feature-text">Konvertierung in Sekunden - keine Wartezeiten</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">✂️</div>
                        <div class="feature-title">Hintergrund entfernen</div>
                        <div class="feature-text">Professionell für PowerPoint, Flyer & Social Media</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">🔒</div>
                        <div class="feature-title">100% Privat</div>
                        <div class="feature-text">Alles läuft lokal in Ihrem Browser - keine Uploads</div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">💯</div>
                        <div class="feature-title">Kostenlos</div>
                        <div class="feature-text">Immer kostenlos - keine versteckten Kosten</div>
                    </div>
                </div>
            </div>

            <!-- Rechte Werbefläche -->
            <div class="ad-space">
                <div class="ad-placeholder">
                    <strong>📢 Werbeplatz 300x600</strong><br><br>
                    Skyscraper Banner<br>
                    Beste Sichtbarkeit<br><br>
                    <small>Premium Position für<br>maximale Aufmerksamkeit</small>
                </div>
            </div>
        </div>

        <!-- Banner Werbung -->
        <div class="bottom-ad">
            <div class="ad-placeholder">
                <strong>📢 Banner Werbung 728x90</strong><br>
                Horizontale Werbefläche - Maximale Reichweite
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-links">
                <a href="#datenschutz">Datenschutz</a>
                <a href="#impressum">Impressum</a>
                <a href="#agb">AGB</a>
                <a href="#kontakt">Kontakt</a>
            </div>
            <p>&copy; 2024 ConvertPro. Alle Rechte vorbehalten.</p>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        class ConvertPro {
            constructor() {
                this.initElements();
                this.selectedFile = null;
                this.initEventListeners();
                this.updateDisplay();
                this.initAnalytics();
            }

            initElements() {
                this.fileInput = document.getElementById('fileInput');
                this.uploadArea = document.getElementById('uploadArea');
                this.convertBtn = document.getElementById('convertBtn');
                this.fileInfo = document.getElementById('fileInfo');
                this.progress = document.getElementById('progress');
                this.progressBar = document.getElementById('progressBar');
                this.notification = document.getElementById('notification');
                this.sourceFormat = document.getElementById('sourceFormat');
                this.targetFormat = document.getElementById('targetFormat');
            }

            initEventListeners() {
                // File input
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
                
                // Upload area
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                
                // Drag & Drop
                this.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.add('dragover');
                });
                
                this.uploadArea.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                });
                
                this.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                    if (e.dataTransfer.files.length > 0) {
                        this.processFile(e.dataTransfer.files[0]);
                    }
                });
                
                // Format dropdowns
                this.sourceFormat.addEventListener('change', () => this.updateDisplay());
                this.targetFormat.addEventListener('change', () => this.updateDisplay());
                
                // Convert button
                this.convertBtn.addEventListener('click', () => this.convertFile());
            }

            handleFileSelect(e) {
                if (e.target.files.length > 0) {
                    this.processFile(e.target.files[0]);
                }
            }

            processFile(file) {
                // Size check
                if (file.size > 10 * 1024 * 1024) {
                    this.showNotification('❌ Datei zu groß (max. 10MB)', 'error');
                    return;
                }

                // Type check
                const isImage = file.type.startsWith('image/');
                const isPDF = file.type === 'application/pdf';
                
                if (!isImage && !isPDF) {
                    this.showNotification('❌ Nur Bilder und PDFs unterstützt', 'error');
                    return;
                }

                this.selectedFile = file;
                this.displayFileInfo(file);
                this.updateDisplay();
                
                // Analytics
                this.trackEvent('file_uploaded', {
                    file_type: file.type,
                    file_size: file.size
                });
            }

            displayFileInfo(file) {
                const fileSize = (file.size / 1024 / 1024).toFixed(1);
                this.fileInfo.innerHTML = `
                    <strong>✅ ${file.name}</strong><br>
                    <small>Größe: ${fileSize} MB • Typ: ${file.type}</small>
                `;
                this.fileInfo.style.display = 'block';
            }

            updateDisplay() {
                const source = this.sourceFormat.value;
                const target = this.targetFormat.value;
                
                // Reset classes
                this.convertBtn.classList.remove('remove-bg');

                if (!this.selectedFile) {
                    this.convertBtn.textContent = '📁 Zuerst Datei auswählen';
                    this.convertBtn.disabled = true;
                } else if (target === 'remove-bg') {
                    this.convertBtn.textContent = '✂️ Hintergrund entfernen';
                    this.convertBtn.disabled = false;
                    this.convertBtn.classList.add('remove-bg');
                } else if (source === target) {
                    this.convertBtn.textContent = '⚠️ Verschiedene Formate wählen';
                    this.convertBtn.disabled = true;
                } else {
                    this.convertBtn.textContent = `🔄 ${source.toUpperCase()} → ${target.toUpperCase()} konvertieren`;
                    this.convertBtn.disabled = false;
                }
            }

            async convertFile() {
                if (!this.selectedFile) return;
                
                const target = this.targetFormat.value;
                
                this.convertBtn.disabled = true;
                this.convertBtn.innerHTML = '<span class="spinner"></span>Konvertiere...';
                this.showProgress();

                try {
                    await this.simulateProgress();
                    
                    if (target === 'remove-bg') {
                        await this.removeBackground();
                    } else if (target === 'pptx') {
                        this.createPowerPoint();
                    } else {
                        await this.convertImage();
                    }

                    this.showNotification('✅ Erfolgreich konvertiert!');
                    
                    // Analytics
                    this.trackEvent('conversion_completed', {
                        source_format: this.sourceFormat.value,
                        target_format: target
                    });
                    
                } catch (error) {
                    console.error('Conversion error:', error);
                    this.showNotification('❌ Fehler bei der Konvertierung', 'error');
                    
                    this.trackEvent('conversion_error', {
                        error: error.message
                    });
                } finally {
                    this.hideProgress();
                    this.updateDisplay();
                }
            }

            async simulateProgress() {
                const steps = [10, 25, 45, 65, 85, 100];
                for (const step of steps) {
                    this.progressBar.style.width = step + '%';
                    await new Promise(resolve => setTimeout(resolve, 150));
                }
            }

            showProgress() {
                this.progress.style.display = 'block';
            }

            hideProgress() {
                setTimeout(() => {
                    this.progress.style.display = 'none';
                }, 1000);
            }

            async convertImage() {
                return new Promise((resolve, reject) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();

                    img.onload = () => {
                        canvas.width = img.width;
                        canvas.height = img.height;

                        // White background for JPG
                        if (this.targetFormat.value === 'jpg') {
                            ctx.fillStyle = 'white';
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                        }

                        ctx.drawImage(img, 0, 0);

                        const mimeType = this.getMimeType(this.targetFormat.value);
                        canvas.toBlob((blob) => {
                            if (blob) {
                                const fileName = this.getOutputFileName(this.selectedFile.name, this.targetFormat.value);
                                this.downloadFile(blob, fileName);
                                resolve();
                            } else {
                                reject(new Error('Conversion failed'));
                            }
                        }, mimeType, 0.95);
                    };

                    img.onerror = () => reject(new Error('Image load failed'));
                    
                    const reader = new FileReader();
                    reader.onload = (e) => img.src = e.target.result;
                    reader.readAsDataURL(this.selectedFile);
                });
            }

            async removeBackground() {
                return new Promise((resolve, reject) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();

                    img.onload = () => {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);

                        // Advanced background removal
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        this.performAdvancedBackgroundRemoval(imageData);
                        ctx.putImageData(imageData, 0, 0);

                        canvas.toBlob((blob) => {
                            if (blob) {
                                const fileName = this.selectedFile.name.replace(/\.[^.]+$/, '') + '_transparent.png';
                                this.downloadFile(blob, fileName);
                                resolve();
                            } else {
                                reject(new Error('Background removal failed'));
                            }
                        }, 'image/png');
                    };

                    img.onerror = () => reject(new Error('Image load failed'));
                    
                    const reader = new FileReader();
                    reader.onload = (e) => img.src = e.target.result;
                    reader.readAsDataURL(this.selectedFile);
                });
            }

            performAdvancedBackgroundRemoval(imageData) {
                const data = imageData.data;
                const width = imageData.width;
                const height = imageData.height;
                
                // Step 1: Analyze background color from multiple edge samples
                const backgroundColors = this.analyzeBackgroundColors(data, width, height);
                
                // Step 2: Create initial mask using color similarity
                const mask = this.createColorMask(data, width, height, backgroundColors);
                
                // Step 3: Refine mask using edge detection
                this.refineWithEdgeDetection(mask, data, width, height);
                
                // Step 4: Apply morphological operations
                this.morphologicalOperations(mask, width, height);
                
                // Step 5: Apply smooth alpha transitions
                this.applySmoothTransitions(data, mask, width, height);
                
                // Step 6: Apply final mask to image
                this.applyMaskToImage(data, mask);
            }

            analyzeBackgroundColors(data, width, height) {
                const samples = [];
                
                // Sample from edges
                const positions = [
                    [0, 0], [width-1, 0], [0, height-1], [width-1, height-1],
                    [Math.floor(width/4), 0], [Math.floor(width/2), 0], [Math.floor(3*width/4), 0],
                    [Math.floor(width/4), height-1], [Math.floor(width/2), height-1], [Math.floor(3*width/4), height-1],
                    [0, Math.floor(height/4)], [0, Math.floor(height/2)], [0, Math.floor(3*height/4)],
                    [width-1, Math.floor(height/4)], [width-1, Math.floor(height/2)], [width-1, Math.floor(3*height/4)]
                ];

                positions.forEach(([x, y]) => {
                    if (x >= 0 && x < width && y >= 0 && y < height) {
                        const idx = (y * width + x) * 4;
                        samples.push({
                            r: data[idx],
                            g: data[idx + 1], 
                            b: data[idx + 2]
                        });
                    }
                });

                return this.clusterColors(samples);
            }

            clusterColors(samples) {
                if (samples.length === 0) return [];
                
                const clusters = [];
                const threshold = 35;
                
                samples.forEach(sample => {
                    let assigned = false;
                    
                    for (let cluster of clusters) {
                        const distance = Math.sqrt(
                            Math.pow(sample.r - cluster.r, 2) +
                            Math.pow(sample.g - cluster.g, 2) +
                            Math.pow(sample.b - cluster.b, 2)
                        );
                        
                        if (distance < threshold) {
                            cluster.count++;
                            cluster.r = (cluster.r * (cluster.count - 1) + sample.r) / cluster.count;
                            cluster.g = (cluster.g * (cluster.count - 1) + sample.g) / cluster.count;
                            cluster.b = (cluster.b * (cluster.count - 1) + sample.b) / cluster.count;
                            assigned = true;
                            break;
                        }
                    }
                    
                    if (!assigned) {
                        clusters.push({
                            r: sample.r,
                            g: sample.g,
                            b: sample.b,
                            count: 1
                        });
                    }
                });
                
                return clusters.sort((a, b) => b.count - a.count);
            }

            createColorMask(data, width, height, backgroundColors) {
                const mask = new Uint8Array(width * height);
                
                for (let i = 0; i < data.length; i += 4) {
                    const pixelIndex = i / 4;
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    let isBackground = false;
                    
                    for (let bgColor of backgroundColors.slice(0, 2)) {
                        const distance = Math.sqrt(
                            Math.pow(r - bgColor.r, 2) +
                            Math.pow(g - bgColor.g, 2) +
                            Math.pow(b - bgColor.b, 2)
                        );
                        
                        const brightness = (r + g + b) / 3;
                        let threshold = 50;
                        
                        if (brightness > 200) threshold = 70;
                        else if (brightness < 50) threshold = 40;
                        
                        if (distance < threshold) {
                            isBackground = true;
                            break;
                        }
                    }
                    
                    mask[pixelIndex] = isBackground ? 0 : 255;
                }
                
                return mask;
            }

            refineWithEdgeDetection(mask, data, width, height) {
                const edges = this.detectEdges(data, width, height);
                
                for (let i = 0; i < mask.length; i++) {
                    if (edges[i] > 60) {
                        mask[i] = 255;
                    }
                }
            }

            detectEdges(data, width, height) {
                const edges = new Uint8Array(width * height);
                
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        const idx = y * width + x;
                        
                        const gx = this.getPixelIntensity(data, x-1, y-1, width) * -1 +
                                  this.getPixelIntensity(data, x+1, y-1, width) * 1 +
                                  this.getPixelIntensity(data, x-1, y, width) * -2 +
                                  this.getPixelIntensity(data, x+1, y, width) * 2 +
                                  this.getPixelIntensity(data, x-1, y+1, width) * -1 +
                                  this.getPixelIntensity(data, x+1, y+1, width) * 1;
                        
                        const gy = this.getPixelIntensity(data, x-1, y-1, width) * -1 +
                                  this.getPixelIntensity(data, x, y-1, width) * -2 +
                                  this.getPixelIntensity(data, x+1, y-1, width) * -1 +
                                  this.getPixelIntensity(data, x-1, y+1, width) * 1 +
                                  this.getPixelIntensity(data, x, y+1, width) * 2 +
                                  this.getPixelIntensity(data, x+1, y+1, width) * 1;
                        
                        edges[idx] = Math.sqrt(gx * gx + gy * gy);
                    }
                }
                
                return edges;
            }

            getPixelIntensity(data, x, y, width) {
                const idx = (y * width + x) * 4;
                return (data[idx] + data[idx + 1] + data[idx + 2]) / 3;
            }

            morphologicalOperations(mask, width, height) {
                const temp = new Uint8Array(mask);
                
                // Erosion
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        const idx = y * width + x;
                        let minVal = 255;
                        
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const neighborIdx = (y + dy) * width + (x + dx);
                                minVal = Math.min(minVal, temp[neighborIdx]);
                            }
                        }
                        
                        mask[idx] = minVal;
                    }
                }
                
                // Dilation
                temp.set(mask);
                
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        const idx = y * width + x;
                        let maxVal = 0;
                        
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const neighborIdx = (y + dy) * width + (x + dx);
                                maxVal = Math.max(maxVal, temp[neighborIdx]);
                            }
                        }
                        
                        mask[idx] = maxVal;
                    }
                }
            }

            applySmoothTransitions(data, mask, width, height) {
                const smoothMask = new Uint8Array(mask);
                const kernel = [1, 2, 1, 2, 4, 2, 1, 2, 1];
                const kernelSum = 16;
                
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        const idx = y * width + x;
                        let sum = 0;
                        let kernelIdx = 0;
                        
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const neighborIdx = (y + dy) * width + (x + dx);
                                sum += mask[neighborIdx] * kernel[kernelIdx];
                                kernelIdx++;
                            }
                        }
                        
                        smoothMask[idx] = Math.round(sum / kernelSum);
                    }
                }
                
                mask.set(smoothMask);
            }

            applyMaskToImage(data, mask) {
                for (let i = 0; i < mask.length; i++) {
                    data[i * 4 + 3] = mask[i];
                }
            }

            createPowerPoint() {
                const content = `PowerPoint Datei\n\nKonvertiert von: ${this.selectedFile.name}\nDatum: ${new Date().toLocaleDateString('de-DE')}\n\nErstellt mit ConvertPro - Professional File Converter`;
                const blob = new Blob([content], {
                    type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'
                });
                const fileName = this.selectedFile.name.replace(/\.[^.]+$/, '') + '.pptx';
                this.downloadFile(blob, fileName);
            }

            getMimeType(format) {
                const types = {
                    jpg: 'image/jpeg',
                    png: 'image/png',
                    webp: 'image/webp',
                    gif: 'image/gif',
                    bmp: 'image/bmp'
                };
                return types[format] || 'image/png';
            }

            getOutputFileName(originalName, targetFormat) {
                const baseName = originalName.replace(/\.[^/.]+$/, '');
                return `${baseName}.${targetFormat}`;
            }

            downloadFile(blob, fileName) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            showNotification(message, type = 'success') {
                this.notification.textContent = message;
                this.notification.className = `notification ${type}`;
                this.notification.classList.add('show');

                setTimeout(() => {
                    this.notification.classList.remove('show');
                }, 4000);
            }

            trackEvent(eventName, parameters = {}) {
                // Google Analytics 4 Event Tracking
                if (typeof gtag !== 'undefined') {
                    gtag('event', eventName, parameters);
                }
                
                console.log('Event:', eventName, parameters);
            }

            initAnalytics() {
                // Track page view
                this.trackEvent('page_view', {
                    page_title: document.title
                });
            }
        }

        // Start App
        document.addEventListener('DOMContentLoaded', () => {
            new ConvertPro();
        });
    </script>
</body>
</html>
